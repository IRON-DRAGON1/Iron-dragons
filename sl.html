<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Summer Slot Machine</title>
<style>
    body {
        margin: 0;
        padding: 0;
        background: linear-gradient(135deg, #87CEEB 0%, #F0E68C 50%, #FF6347 100%);
        background-attachment: fixed;
        font-family: Arial, sans-serif;
        height: 100vh;
        overflow: hidden;
        touch-action: manipulation;
    }

    /* Background overlay pattern */
    body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: 
            radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 75% 75%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
        pointer-events: none;
        z-index: 1;
    }

    /* Main container with your background image */
    .game-wrapper {
        position: relative;
        width: 100vw;
        height: 100vh;
        background: url('./Games/Iron dragons/spin.png') no-repeat center center;
        background-size: contain;
        z-index: 2;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    /* Precise positioning for the black box area */
    .slot-container {
        position: absolute;
        /* More precise positioning based on the image */
        left: 50%;
        transform: translateX(-50%);
        width: 12%;
        height: 18%;
        background: transparent;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        gap: clamp(3px, 0.6vh, 6px);
        border-radius: 4px;
    }

    .slots {
        display: flex;
        justify-content: center;
    }

    .slot {
        width: clamp(50px, 4vw, 60px);
        height: clamp(50px, 4vw, 60px);
        background: linear-gradient(145deg, #fff, #f0f0f0);
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 8px;
        box-shadow: 
            0 2px 4px rgba(0,0,0,0.3),
            inset 0 1px 1px rgba(255,255,255,0.4);
        overflow: hidden;
        border: 2px solid #FFD700;
        transition: transform 0.3s ease;
    }

    .slot:hover {
        transform: scale(1.05);
    }

    .slot img {
        max-width: 95%;
        max-height: 95%;
        object-fit: contain;
    }

    .spin-button {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        top: calc(var(--slot-container-bottom) + 50px);
        padding: clamp(12px, 2.5vh, 20px) clamp(24px, 5vw, 40px);
        font-size: clamp(16px, 3vw, 22px);
        background: linear-gradient(145deg, #FF6347, #FF4500);
        border: none;
        border-radius: 12px;
        cursor: pointer;
        font-weight: bold;
        color: white;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
        box-shadow: 
            0 3px 6px rgba(0,0,0,0.4),
            inset 0 1px 2px rgba(255,255,255,0.3);
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-top: 150px;
        touch-action: manipulation;
    }

    .spin-button:hover:not(:disabled) {
        background: linear-gradient(145deg, #FF4500, #FF6347);
        box-shadow: 
            0 6px 12px rgba(0,0,0,0.5),
            inset 0 1px 2px rgba(255,255,255,0.4);
    }

    .spin-button:active:not(:disabled) {
        transform: translateY(0px);
        box-shadow: 
            0 2px 4px rgba(0,0,0,0.3),
            inset 0 1px 2px rgba(255,255,255,0.2);
    }

    .spin-button:disabled {
        background: linear-gradient(145deg, #999, #666);
        cursor: not-allowed;
        transform: none;
    }

    .message {
        color: #FFD700;
        font-weight: bold;
        text-align: center;
        font-size: clamp(8px, 1.4vw, 12px);
        text-shadow: 1px 1px 3px rgba(0,0,0,0.9);
        min-height: clamp(12px, 2.5vh, 18px);
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        max-width: 100%;
        line-height: 1.2;
    }

    /* Status overlay when not time to spin */
    .status-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, #87CEEB 0%, #F0E68C 50%, #FF6347 100%);
        backdrop-filter: blur(10px);
        z-index: 1000;
        display: flex;
        justify-content: center;
        align-items: center;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
    }

    .status-overlay.active {
        opacity: 1;
        visibility: visible;
    }

    .status-card {
        background: linear-gradient(145deg, #2c3e50, #34495e);
        border-radius: 20px;
        padding: clamp(20px, 4vw, 40px);
        box-shadow: 
            0 20px 40px rgba(0, 0, 0, 0.3),
            0 0 0 1px rgba(255, 255, 255, 0.1);
        text-align: center;
        max-width: 90%;
        width: clamp(300px, 50vw, 500px);
        position: relative;
        overflow: hidden;
    }

    .status-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #FF6347, #FFD700, #FF6347);
        animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }

    .status-icon {
        font-size: clamp(40px, 8vw, 60px);
        margin-bottom: clamp(10px, 2vw, 15px);
        display: block;
    }

    .status-title {
        color: #FFD700;
        font-size: clamp(18px, 4vw, 24px);
        font-weight: bold;
        margin-bottom: clamp(10px, 2vw, 15px);
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    }

    .status-message {
        color: #ecf0f1;
        font-size: clamp(14px, 3vw, 18px);
        line-height: 1.5;
        margin-bottom: clamp(15px, 3vw, 20px);
    }

    .countdown-timer {
        background: linear-gradient(145deg, #e74c3c, #c0392b);
        color: white;
        padding: clamp(8px, 2vw, 12px) clamp(15px, 3vw, 20px);
        border-radius: 10px;
        font-size: clamp(16px, 3.5vw, 20px);
        font-weight: bold;
        margin-top: clamp(10px, 2vw, 15px);
        box-shadow: 0 4px 8px rgba(231, 76, 60, 0.3);
        letter-spacing: 1px;
    }

    .prize-info {
        background: rgba(52, 73, 94, 0.7);
        border-radius: 12px;
        padding: clamp(12px, 2.5vw, 15px);
        margin-top: clamp(10px, 2vw, 15px);
        border: 1px solid rgba(255, 215, 0, 0.3);
    }

    .prize-title {
        color: #FFD700;
        font-size: clamp(14px, 3vw, 16px);
        font-weight: bold;
        margin-bottom: clamp(8px, 1.5vw, 10px);
    }

    .prize-text {
        color: #bdc3c7;
        font-size: clamp(12px, 2.5vw, 14px);
        line-height: 1.4;
    }

    /* Game schedule info */
    .schedule-info {
        color: #95a5a6;
        font-size: clamp(12px, 2.5vw, 14px);
        margin-top: clamp(15px, 3vw, 20px);
        padding-top: clamp(12px, 2.5vw, 15px);
        border-top: 1px solid rgba(149, 165, 166, 0.3);
    }

    /* Spinning animation */
    @keyframes spin {
        0% { transform: rotateY(0deg); }
        50% { transform: rotateY(180deg); }
        100% { transform: rotateY(360deg); }
    }

    .slot.spinning {
        animation: spin 0.6s ease-in-out;
    }

    /* Winning celebration animation */
    @keyframes celebrate {
        0%, 100% { transform: scale(1) rotate(0deg); }
        25% { transform: scale(1.1) rotate(-5deg); }
        50% { transform: scale(1.15) rotate(0deg); }
        75% { transform: scale(1.1) rotate(5deg); }
    }

    .slot.winner {
        animation: celebrate 1s ease-in-out;
        border-color: #00FF00;
        box-shadow: 0 0 20px #00FF00;
    }

    /* Responsive adjustments for different screen ratios */
    :root {
        --slot-container-top: 30.5%;
        --slot-container-height: 16%;
    }

    .game-wrapper {
        --slot-container-bottom: calc(var(--slot-container-top) + var(--slot-container-height));
    }

    /* Enhanced Mobile Styles */
    @media (max-width: 768px) {
        :root {
            --slot-container-top: 25%;
            --slot-container-height: 35%;
        }
        
        .slot-container {
            width: 45%;
            height: var(--slot-container-height);
            top: var(--slot-container-top);
            gap: clamp(5px, 1.2vh, 8px);
        }
        
        .slot {
            width: clamp(50px, 8vw, 70px);
            height: clamp(50px, 8vw, 70px);
            border-width: 3px;
            border-radius: 12px;
            box-shadow: 
                0 4px 8px rgba(0,0,0,0.4),
                inset 0 2px 2px rgba(255,255,255,0.5);
        }
        
        .message {
            font-size: clamp(12px, 3vw, 16px);
            min-height: clamp(18px, 4vh, 24px);
            font-weight: 800;
        }
        
        .spin-button {
            padding: clamp(18px, 4vh, 24px) clamp(30px, 8vw, 50px);
            font-size: clamp(18px, 4.5vw, 24px);
            border-radius: 16px;
            margin-top: clamp(80px, 15vh, 120px);
            letter-spacing: 1px;
            min-height: 60px;
        }
        
        /* Enhanced status overlay for mobile */
        .status-card {
            width: clamp(320px, 85vw, 450px);
            padding: clamp(25px, 5vw, 35px);
            border-radius: 24px;
            margin: 20px;
        }
        
        .status-icon {
            font-size: clamp(50px, 12vw, 70px);
            margin-bottom: clamp(15px, 3vw, 20px);
        }
        
        .status-title {
            font-size: clamp(22px, 5.5vw, 28px);
            margin-bottom: clamp(15px, 3vw, 20px);
        }
        
        .status-message {
            font-size: clamp(16px, 4vw, 20px);
            line-height: 1.6;
            margin-bottom: clamp(20px, 4vw, 25px);
        }
        
        .countdown-timer {
            padding: clamp(12px, 3vw, 16px) clamp(20px, 4vw, 25px);
            font-size: clamp(18px, 4.5vw, 22px);
            border-radius: 14px;
            margin-top: clamp(15px, 3vw, 20px);
        }
        
        .prize-info {
            padding: clamp(16px, 3.5vw, 20px);
            margin-top: clamp(15px, 3vw, 20px);
            border-radius: 16px;
        }
        
        .prize-title {
            font-size: clamp(16px, 4vw, 18px);
            margin-bottom: clamp(12px, 2.5vw, 15px);
        }
        
        .prize-text {
            font-size: clamp(14px, 3.5vw, 16px);
            line-height: 1.5;
        }
        
        .schedule-info {
            font-size: clamp(14px, 3.5vw, 16px);
            margin-top: clamp(20px, 4vw, 25px);
            padding-top: clamp(16px, 3.5vw, 20px);
            line-height: 1.6;
        }
    }

    /* Extra enhancements for smaller mobile devices */
    @media (max-width: 480px) {
        :root {
            --slot-container-top: 25%;
            --slot-container-height: 40%;
        }
        
        .slot-container {
            width: 55%;
            height: var(--slot-container-height);
            top: var(--slot-container-top);
            gap: clamp(8px, 2vh, 12px);
        }
        
        .slot {
            width: clamp(40px, 10vw, 60px);
            height: clamp(40px, 10vw, 60px);
            border-width: 4px;
            border-radius: 16px;
        }
        
        .message {
            font-size: clamp(14px, 3.5vw, 18px);
            min-height: clamp(20px, 5vh, 28px);
        }
        
        .spin-button {
            padding: clamp(20px, 5vh, 28px) clamp(35px, 10vw, 60px);
            font-size: clamp(20px, 5vw, 26px);
            margin-top: clamp(50px, 10vh, 70px);
            min-height: 70px;
            border-radius: 18px;
        }
        
        .status-card {
            width: clamp(300px, 90vw, 400px);
            margin: 15px;
        }
    }

    /* Landscape mobile optimization */
    @media (max-width: 768px) and (orientation: landscape) {
        :root {
            --slot-container-top: 20%;
            --slot-container-height: 45%;
        }
        
        .slot-container {
            width: 35%;
            height: var(--slot-container-height);
            top: var(--slot-container-top);
        }
        
        .spin-button {
            margin-top: clamp(40px, 8vh, 60px);
            padding: clamp(14px, 3vh, 18px) clamp(25px, 6vw, 40px);
        }
        
        .status-card {
            width: clamp(280px, 60vw, 400px);
            max-height: 85vh;
            overflow-y: auto;
        }
    }

    /* Desktop and larger screens */
    @media (min-width: 1200px) {
        :root {
            --slot-container-top: 37.5%;
            --slot-container-height: 16%;
        }
        .slot-container {
            top: var(--slot-container-top);
            width: 10.5%;
            height: var(--slot-container-height);
        }
    }

    /* Fallback for when background image doesn't load */
    .game-wrapper.no-bg {
        background: linear-gradient(135deg, #ff9a56 0%, #ff6b6b 50%, #4ecdc4 100%);
    }
    
    .game-wrapper.no-bg .slot-container {
        background: rgba(139, 69, 19, 0.9);
        border: 3px solid #FFD700;
        top: 50%;
        transform: translate(-50%, -50%);
    }
    .cloud-text {
        position: absolute;
        font-family: 'Arial', sans-serif;
        font-weight: bold;
        color: #333;
        text-align: center;
        text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
        line-height: 1.2;
        padding: 5px;
        word-break: break-word;
    }

    /* Left cloud */
    .cloud-left {
        top: 20%;
        left: 36%;
        font-size: clamp(12px, 1.8vw, 24px);
        max-width: 18%;
        transform: rotate(-4deg);
    }

    /* Right cloud */
    .cloud-right {
        top: 25%;
        right: 35%;
        font-size: clamp(12px, 1.8vw, 24px);
        max-width: 18%;
        transform: rotate(20deg);
    }


    /* Mobile adjustments */
    @media (max-width: 768px) {
        .cloud-left, .cloud-right {
            font-size: clamp(35px, 5vw, 40px);
            max-width: 25%;
        }
        .cloud-left {
            top: 15%;
            left: 12%;
        }
        .cloud-right {
            top: 23%;
            right: 8%;
        }
    }

</style>
</head>
<body>

<div class="game-wrapper">
   
    <div class="slot-container">
        <div class="message" id="message">Ready to play!</div>
        <div class="slots">
            <div class="slot"><img src="./Games/pubg/coins_.png" alt="60 UC"></div>
            <div class="slot"><img src="./Games/roblox/coins.png" alt="40 Roblox"></div>
            <div class="slot"><img src="./Games/pubg/coins_.png" alt="60 UC"></div>
        </div>
    </div>
    <button class="spin-button" id="spinBtn">üé∞ SPIN</button>
</div>

<!-- Status overlay for when it's not time to spin -->
<div class="status-overlay" id="statusOverlay">
    <div class="status-card">
        <div class="status-icon" id="statusIcon">‚è∞</div>
        <div class="status-title" id="statusTitle">Game Closed</div>
        <div class="status-message" id="statusMessage">The slot machine is currently closed.</div>
        <div class="countdown-timer" id="countdownTimer" style="display: none;">00:00:00</div>
        
        <div class="prize-info">
            <div class="prize-title">üéÅ Available Prizes</div>
            <div class="prize-text">60 UC ‚Ä¢ 40 Roblox ‚Ä¢ 110 Free Fire</div>
        </div>
        
        <div class="schedule-info">
            üóìÔ∏è Game opens every Thursday<br>
            üïê Time: 2:00 PM - 3:30 PM<br>
            üéØ One spin per week
        </div>
    </div>
</div>

<script>
// Game prizes with actual image paths
const prizes = [
    { name: '60 UC', image: './Games/pubg/coins_.png' },
    { name: '40 Roblox', image: './Games/roblox/coins.png' },
    { name: '110 Free Fire', image: './Games/free fire/coins.png' }
];

const spinBtn = document.getElementById('spinBtn');
const slots = document.querySelectorAll('.slot');
const slotImages = document.querySelectorAll('.slot img');
const message = document.getElementById('message');
const statusOverlay = document.getElementById('statusOverlay');
const statusIcon = document.getElementById('statusIcon');
const statusTitle = document.getElementById('statusTitle');
const statusMessage = document.getElementById('statusMessage');
const countdownTimer = document.getElementById('countdownTimer');

// Game state stored in memory (no localStorage in artifacts)
let gameData = {};
let lastWinningPrize = ''; // Store the last winning prize

function isThursdayInTimeRange() {
    // For testing purposes, always return true
    return true;
}

function getTimeStatus() {
    // For testing purposes, always return correct_time
    return 'correct_time';
}

function getCountdownToSpin() {
    const now = new Date();
    const today = new Date(now);
    today.setHours(14, 0, 0, 0); // Set to 2:00 PM today
    
    const timeDiff = today - now;
    const hours = Math.floor(Math.abs(timeDiff) / (1000 * 60 * 60));
    const minutes = Math.floor((Math.abs(timeDiff) % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((Math.abs(timeDiff) % (1000 * 60)) / 1000);
    
    return {
        hours,
        minutes,
        seconds,
        formatted: `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`
    };
}

function getNextThursdayCountdown() {
    const now = new Date();
    const nextThursday = new Date(now);
    const daysUntilThursday = (4 - now.getDay() + 7) % 7;
    
    if (daysUntilThursday === 0) {
        // It's Thursday, but check if we're past the time window
        const currentTime = now.getHours() * 60 + now.getMinutes();
        if (currentTime > 15 * 60 + 30) {
            // Past the window, go to next Thursday
            nextThursday.setDate(now.getDate() + 7);
        }
    } else {
        nextThursday.setDate(now.getDate() + (daysUntilThursday || 7));
    }
    
    nextThursday.setHours(14, 0, 0, 0); // Set to 2:00 PM
    
    const timeDiff = nextThursday - now;
    const days = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
    const hours = Math.floor((timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);
    
    return {
        days,
        hours,
        minutes,
        seconds,
        formatted: days > 0 ? `${days}d ${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}` 
                            : `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`
    };
}

function getWeekKey() {
    const now = new Date();
    const year = now.getFullYear();
    // Get the Thursday of current week to use as week identifier
    const startOfYear = new Date(year, 0, 1);
    const days = Math.floor((now - startOfYear) / (24 * 60 * 60 * 1000));
    const weekNumber = Math.ceil((days + startOfYear.getDay() + 1) / 7);
    return `${year}-W${weekNumber}`;
}

function hasSpunThisWeek() {
    const key = getWeekKey();
    return gameData[key] && gameData[key].hasSpun === true;
}

function getLastWinningPrize() {
    const key = getWeekKey();
    return gameData[key] ? gameData[key].winningPrize : '';
}

function markAsSpun(winningPrize) {
    const key = getWeekKey();
    gameData[key] = {
        hasSpun: true,
        winningPrize: winningPrize
    };
}

// Function to guarantee a win by ensuring at least one matching result
function generateWinningResult() {
    // Pick a random prize to be the winning one
    const winningPrize = prizes[Math.floor(Math.random() * prizes.length)];
    
    // Decide randomly how many slots will match (1, 2, or 3 for guaranteed win)
    const matchCount = Math.random() < 0.7 ? 3 : 2; // 70% chance for jackpot (3 matches)
    
    const result = [];
    
    if (matchCount === 3) {
        // All three match - jackpot
        result.push(winningPrize, winningPrize, winningPrize);
    } else {
        // Two match, one different
        const otherPrize = prizes.find(p => p.name !== winningPrize.name) || prizes[0];
        result.push(winningPrize, winningPrize, otherPrize);
        
        // Randomly shuffle the positions
        for (let i = result.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [result[i], result[j]] = [result[j], result[i]];
        }
    }
    
    return result;
}

function updateStatusOverlay() {
    const timeStatus = getTimeStatus();
    
    if (timeStatus === 'correct_time' && !hasSpunThisWeek()) {
        // It's time to spin and user hasn't spun yet - hide overlay
        statusOverlay.classList.remove('active');
        return;
    }
    
    // Show overlay with appropriate message
    statusOverlay.classList.add('active');
    
    if (hasSpunThisWeek()) {
        const winningPrize = getLastWinningPrize();
        statusIcon.textContent = 'üéä';
        statusTitle.textContent = 'Congratulations!';
        statusMessage.textContent = `You've already won ${winningPrize} this week! Come back next Thursday for another chance to win.`;
        countdownTimer.style.display = 'block';
        
        // Show countdown to next Thursday
        const countdown = getNextThursdayCountdown();
        countdownTimer.textContent = `Next game in: ${countdown.formatted}`;
    } else {
        switch (timeStatus) {
            case 'wrong_day':
                statusIcon.textContent = 'üìÖ';
                statusTitle.textContent = 'Come Back Thursday!';
                statusMessage.textContent = 'The slot machine is only available on Thursdays between 2:00 PM and 3:30 PM. Mark your calendar!';
                countdownTimer.style.display = 'block';
                
                const countdown = getNextThursdayCountdown();
                countdownTimer.textContent = `Next game in: ${countdown.formatted}`;
                break;
                
            case 'before_time':
                statusIcon.textContent = '‚è∞';
                statusTitle.textContent = 'Almost Time!';
                statusMessage.textContent = "It's Thursday! The game will open at 2:00 PM. Get ready to spin and win!";
                countdownTimer.style.display = 'block';
                
                const todayCountdown = getCountdownToSpin();
                countdownTimer.textContent = `Opens in: ${todayCountdown.formatted}`;
                break;
                
            case 'after_time':
                statusIcon.textContent = 'üò¥';
                statusTitle.textContent = 'Game Closed';
                statusMessage.textContent = 'You missed today\'s window! The game was open from 2:00 PM to 3:30 PM. Don\'t worry, try again next Thursday!';
                countdownTimer.style.display = 'block';
                
                const nextWeekCountdown = getNextThursdayCountdown();
                countdownTimer.textContent = `Next game in: ${nextWeekCountdown.formatted}`;
                break;
        }
    }
}

async function spin() {
    const timeStatus = getTimeStatus();
    
    if (timeStatus !== 'correct_time') {
        return; // Let updateMessage handle the display
    }
    
    if (hasSpunThisWeek()) {
        return; // Let updateMessage handle the display
    }

    // Disable button during spin
    spinBtn.disabled = true;
    message.textContent = "Spinning...";

    // Add spinning animation
    slots.forEach(slot => slot.classList.add('spinning'));

    // Simulate spinning delay
    await new Promise(resolve => setTimeout(resolve, 1200));

    // Generate guaranteed winning result
    const result = generateWinningResult();

    // Update slot images with results
    for (let i = 0; i < 3; i++) {
        slotImages[i].src = result[i].image;
        slotImages[i].alt = result[i].name;
    }

    // Remove spinning animation
    slots.forEach(slot => slot.classList.remove('spinning'));

    // Check for win type and find winning prize
    const matches = {};
    result.forEach(prize => {
        matches[prize.name] = (matches[prize.name] || 0) + 1;
    });

    // Find the prize with highest matches
    let winningPrize = '';
    let maxMatches = 0;
    for (const [prize, count] of Object.entries(matches)) {
        if (count > maxMatches) {
            maxMatches = count;
            winningPrize = prize;
        }
    }

    // Mark as spun for this week with winning prize
    markAsSpun(winningPrize);

    // Add celebration animation to winning slots
    slots.forEach((slot, index) => {
        if (result[index].name === winningPrize) {
            slot.classList.add('winner');
            setTimeout(() => slot.classList.remove('winner'), 1000);
        }
    });

    // Display winning message
    if (maxMatches === 3) {
        message.textContent = `üéâ JACKPOT! You won ${winningPrize}! üéâ`;
    } else if (maxMatches === 2) {
        message.textContent = `üéÅ You won ${winningPrize}! üéÅ`;
    } else {
        message.textContent = `üéä You won ${winningPrize}! üéä`;
    }

    // Keep button disabled and update message after a delay
    setTimeout(() => {
        updateMessage();
        updateStatusOverlay();
    }, 3000);
}

// Initialize message based on day and time
function updateMessage() {
    const timeStatus = getTimeStatus();
    
    if (hasSpunThisWeek()) {
        const winningPrize = getLastWinningPrize();
        message.textContent = `üéä Congrats! You won ${winningPrize}!`;
        spinBtn.disabled = true;
        return;
    }
    
    switch (timeStatus) {
        case 'wrong_day':
            message.textContent = "Wait until next Thursday!";
            spinBtn.disabled = true;
            break;
            
        case 'before_time':
            const countdown = getCountdownToSpin();
            message.textContent = `Opens in: ${countdown.formatted}`;
            spinBtn.disabled = true;
            break;
            
        case 'after_time':
            message.textContent = "Wait until next Thursday!";
            spinBtn.disabled = true;
            break;
            
        case 'correct_time':
            message.textContent = "üé∞ Ready to win! One spin only!";
            spinBtn.disabled = false;
            break;
    }
}

// Check if background image loads
const gameWrapper = document.querySelector('.game-wrapper');
const bgImage = new Image();
bgImage.onload = function() {
    // Image loaded successfully
};
bgImage.onerror = function() {
    // Image failed to load, add fallback class
    gameWrapper.classList.add('no-bg');
};
bgImage.src = './Games/Iron dragons/spin.png';

spinBtn.addEventListener('click', spin);

// Initialize the game
updateMessage();
updateStatusOverlay();

// Update message and overlay every second for real-time countdown
setInterval(() => {
    updateMessage();
    updateStatusOverlay();
}, 1000);

</script>
</body>
</html>